Добрый день!
Пытался до тебя днем дописаться но не получилось. Поэтому отправлю так. исправил файл dds_rep. так как он огромный и менять пришлось все решил ко второму файлу не приступать а сдать этот на проверку, правильно ли я понял мысль или нет.